## Building better force fields for drug discovery using open data and automated optimization
[The proposed research in this aim will change the way force fields are built and the way they are optimized, to improve their accuracy on biomedical problems.]{.Maroon}

Designing ligands that bind their target with high affinity and specificity is the principal objective of small-molecule drug discovery, yet hit-to-lead and lead-optimization can take upwards of three years owing to the fact it is often necessary to synthesize hundreds or thousands of new compounds.
In short, drug discovery is very expensive and often fails.
In recent years, the pharmaceutical industry has begun to use absolute and relative binding free energy calculations to help narrow the number of compounds that must be synthesized [@doi:10.1007/s10822-016-9998-9; @doi:10.1021/ci4004199].
In particular, the advent of computational calorimetry has enabled quantitative and high-precision comparisons of binding free energies, enthalpies, and entropies (by subtraction) with experimental values determined by isothermal titration calorimetry or NMR [@doi:10.1021/acs.jctc.5b00405].
The root mean squared error associated with such calculations is several kcal/mol [@doi:10.1007/s10822-017-0088-4], and even a modest improvement of the prediction accuracy by 1 kcal/mol would lead to a substantial decrease in the number of compounds that must be manually screened [@tag:improvement].
Although it has been suggested by some that changes in the force field functional form are required, it is clear that there is ample room to improve the accuracy of existing parameters through careful analysis [@doi:10.1021/jp411529h].
The first goal of this aim is to create better tools to guide early-stage drug discovery by reducing the number of compounds that must be synthesized to find a promising hit that can be carried over into clinical trials.

 ![An example host-guest system, $\alpha$-cyclodextrin with cyclooctanol (unbound) showing the pulling coordinate along the $z$ axis.](images/APR-annotated.png){#fig:apr .figure wwidth=3in wpos=L}

While it would be ideal to predict the binding affinity of candidate ligands to proteins, the long sampling required to reach convergence on such systems renders them unsuitable for rapid testing.
Host-guest systems are noncovalent complexes between a cavity-like host molecule and a small molecule guest.
These systems retain many of the same, strong functional group interactions of protein-ligand systems while being computationally tractable. 
In the attach-pull-release (APR) method, the reversible work of transferring the guest from the binding site to solution, via a physical pathway, is computed using a series of umbrella sampling windows (Figure @fig:apr).
In the “attach” phase, restraints are connected to the guest (and optionally, to the host for better conformational sampling) through a parameter $\lambda \in [0, 1]$ that controls the strength of the restraints.
During the “pull” phase, the equilibrium length of a distance restraint joining the guest and host is increased until the guest is no longer interacting with the host molecule. 
The “release” phase reverses the work of attaching the restraints and also corrects the concentration of the guest molecule to standard state.
Simulating each window and integrating over the partial derivative of the restraint energy with respect to the restraint target, we can generate a potential of mean force along the pulling coordinate that is used to compute the binding free energy at standard state, $\Delta G^\circ$.

APR has consistently been ranked among the most accurate methods for predicting binding thermodynamics in blind challenges [@doi:10.1007/s10822-016-9974-4; @doi:10.1007/s10822-014-9735-1]. 
I will independently continue the development of APR, and its Python interface that I developed -- called pAPRika -- by transforming it into a generalized tool that is capable of computing free energies along any physical pathway, using either AMBER or OpenMM as simulation packages.
The core functionality of pAPRika is already being used by research groups across the country and in at least one group in China.
Extending pAPRika would allow the same rigorous thermodynamic framework to be used in applications such as protein-protein interactions, dimerization of small molecules, or nucleotide flipping.
As part of the development, I will also investigate the accuracy of non-pathway, end-point methods, such as the direct calculation of interaction entropy [@doi:10.1021/jacs.6b02682].

Most established small molecule force fields (e.g., the general AMBER force field, GAFF) have been tuned using pure liquid state data, such as the average density, enthalpy of vaporization, or the self-diffusion coefficient.
Over the past decade, it has become clear that reproducing those properties well does not guarantee binding thermodynamics at a level acceptable for guiding experiments.
The open force field group (OpenFF) aims to develop new, collaborative force fields using open access methods, open source software, and high-quality open data sets.
One central difference with the OpenFF group is the use of direct chemical perception to apply force field parameters based on a molecular graph instead of atom types[@doi:10.1101/286542], and the desire to avoid over-fitting parameters by making Monte Carlo moves in parameter space to find the fewest number of parameters required to describe a set of chemistries [@doi:10.26434/chemrxiv.6230627.v2].
The first prototype force field from this effort was release in June 2018, called SMIRNOFF99Frosst v0.1, based on a predecessor of GAFF.
SMIRNOFF99Frosst is able to perform as well as GAFF, and in some cases, alleviate conformational problems caused by GAFF's atom types, in only 335 parameter lines compared to the 6794 lines in GAFF version 2.1. 
Beyond this initial release, multiple generations of SMIRNOFF-based force fields are planned, incorporating new forms of Lennard-Jones interactions, the addition of atom polarizabilities, and Bayesian estimates to quantify systematic errors in the force field.

![A comparison of binding free energies between SMIRNOFF99Frosst and GAFF v1.7 for a series of cyclodextrin hosts and guests (unpublished results). Points are colored according to guest functional group.](images/SMIRNOFF-vs-GAFF-deltaG.png){#fig:smirnoff .figure wwidth=3in wpos=R}

As a member of the OpenFF consortium, I am responsible for benchmarking new iterations of SMIRNOFF-family force fields using host-guest thermodynamics computed by pAPRika.
Figure @fig:smirnoff shows the very first comparison of SMIRNOFF99Frosst v0.1 and GAFF v1.7 on host-guest systems.
GAFF v1.7 is known to overestimate binding affinities by >1 kcal/mol[@doi:10.1021/acs.jctc.7b00359], and it appears that SMIRNOFF99Frosst reduces this tendency.
To begin, I will use the "[benchmark set](https://escholarship.org/uc/item/9p37m6bq)" of Mobley et al.[@doi:10.1146/annurev-biophys-070816-033654].
There, experimental data are available for rigid curcurbituril and highly flexible cyclodextrin hosts with a variety of drug-like guest molecules. 
When available, I plan to incorporate the binding data resulting from selective derivatization of cyclodextrins designed to evaluate specific functional group interactions [@doi:10.26434/chemrxiv.5782224.v1].
Enthalpies are poorly correlated with free energies, and thus, they represent a nearly independent set of data to compare. 
pAPRika makes it easy to match the simulations to the experimental conditions, including host and guest concentration, stoichiometry, ion concentration, and buffer conditions.

To integrate the pAPRika calculations with the OpenFF group, I will leverage the ForceBalance framework.
ForceBalance is a tool, written by Dr. Lee-Ping Wang, that uses thermodynamic fluctuation formulas and reference data (e.g., *ab initio* quantum mechanical calculations and experimentally known molecular or bulk properties) to optimize an objective function, such as the sum of squared differences between the calculated and reference values.
ForceBalance has already been used to optimize water models[@doi:10.1021/jp403802c] and protein force fields [@doi:10.1021/acs.jpcb.7b02320]. 
As a member of the OpenFF consortium, Dr. Wang has begun to add support for the SMIRNOFF force field format. 
I will extend my collaboration with Dr. Wang to include pAPRika in the optimization loop of ForceBalance. 
I have experience working with the analytic derivatives of the binding free energy with respect to Lennard-Jones parameters [@doi:10.1021/acs.jpcb.5b04262], and using these derivatives to tune parameters was recently used by a colleague to optimize the TIP3P water model for binding calculations by post-processing existing MD trajectories for small parameter perturbation [@doi:10.1021/acs.jctc.8b00318].

Together, these methodological improvements will help create a transparent and robust set of metrics to evaluate the performance of candidate force fields on an equal footing.
By incorporating host-guest binding data, the degeneracy in parameter space will be broken, avoiding force fields that agree excellently with experiment for liquid properties and yet agree poorly on binding.
I believe the ideas in this aim could be turned into an NIH proposal by demonstrating the need to systematically evaluate force field accuracy for protein-ligand binding, perhaps the most important application of this work for human health.